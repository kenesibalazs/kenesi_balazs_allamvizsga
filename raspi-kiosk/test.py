import hid
import time

VENDOR_ID = 0x1FC9
PRODUCT_ID = 0x0088

hid_packet = bytes([
    0x1b, 0x00, 0x20, 0x1a, 0x43, 0xf6, 0x0c, 0xae, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x09, 0x00,
    0x00, 0x01, 0x00, 0x05, 0x00, 0x01, 0x01, 0x40, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x67, 0x29, 0x03,
    0x06, 0x00, 0x03, 0x28, 0x00, 0x00, 0x03, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xe0, 0xed, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x00, 0xb1, 0x47, 0x9b, 0x62, 0xfb, 0x7f, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe
])

# Open device
dev = hid.device()
dev.open(VENDOR_ID, PRODUCT_ID)
print("‚úÖ Connected to PN7150 USB Dongle")

# Send the HID command
print("üì§ Sending HID command...")
dev.write(hid_packet)

# Try reading a response
time.sleep(0.1)
response = dev.read(64, timeout_ms=1000)
print("üì• Response:", response if response else "‚ùå No response received")

dev.close()